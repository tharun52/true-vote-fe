<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-12 col-sm-10 col-md-8 col-lg-6">
      <form [formGroup]="pollForm" (ngSubmit)="submit()" enctype="multipart/form-data"
        class="poll-form card p-4 shadow-sm border-0">
        <div class="mb-3">
          <label class="form-label">Title</label>
          <input type="text" formControlName="title" class="form-control" />
          @if (title?.touched && title?.errors) {
          <div class="text-danger small mt-1">Title is required</div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">Description</label>
          <textarea formControlName="description" class="form-control" rows="3"></textarea>
        </div>

        <div class="mb-3">
          <label class="form-label">Start Date</label>
          <input type="date" formControlName="startDate" class="form-control" />
          @if (startDate?.touched && startDate?.errors) {
          <div class="text-danger small mt-1">Start Date is required</div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">End Date</label>
          <input type="date" formControlName="endDate" class="form-control" />
          @if (endDate?.touched && endDate?.errors) {
          <div class="text-danger small mt-1">End Date is required</div>
          }
        </div>

        <div class="mb-3" formArrayName="optionTexts">
          <label class="form-label">Options</label>
          @for (option of optionTexts.controls; track option; let i = $index) {
          <div class="d-flex gap-2 align-items-center mb-2">
            <input [formControlName]="i" class="form-control" />

            @if (option.touched && option.invalid) {
            @if (option.errors?.['required']) {
            <small class="text-danger">Required</small>
            }
            }

            @if (optionTexts.length > 2) {
            <button type="button" (click)="removeOption(i)" class="btn btn-outline-danger btn-sm">‚ùå</button>
            }
          </div>
          }
          <button type="button" class="btn btn-outline-primary btn-sm" (click)="addOption()">+ Add Option</button>
        </div>

        <div class="mb-3">
          <label class="form-label">Poll File (optional)</label>
          <input type="file" class="form-control" (change)="onFileChange($event)" />
        </div>

        <button type="submit" class="btn btn-accent w-100">Create Poll</button>

        <div class="text-danger mt-2 small">{{ responseMessage }}</div>
      </form>
    </div>
  </div>
</div>