<div class="container my-4">
  <div class="row mb-3 g-2 align-items-end">
    <div class="col-md-4">
      <label class="form-label">üîç Search</label>
      <input type="text" class="form-control" [formControl]="searchControl" placeholder="Search polls..." />
    </div>

    <div class="col-md-2">
      <label class="form-label">Sort By</label>
      <select class="form-select" [(ngModel)]="sortBy" (change)="loadPolls()">
        <option value="">-- None --</option>
        <option value="title">Title</option>
        <option value="startDate">Start Date</option>
      </select>
    </div>

    <div class="col-md-2">
      <label class="form-label">Order</label>
      <select class="form-select" [(ngModel)]="sortDesc" (change)="loadPolls()">
        <option [ngValue]="false">Ascending</option>
        <option [ngValue]="true">Descending</option>
      </select>
    </div>

    <div class="col-md-2">
      <label class="form-label">From</label>
      <input type="date" class="form-control" [(ngModel)]="startDateFrom" (change)="loadPolls()" />
    </div>

    <div class="col-md-2">
      <label class="form-label">To</label>
      <input type="date" class="form-control" [(ngModel)]="startDateTo" (change)="loadPolls()" />
    </div>

    <div class="col-md-12 mt-2">
      <button class="btn btn-outline-secondary btn-sm" (click)="resetFilters()">Reset Filters</button>
    </div>
  </div>

  <div class="row">
    @if (errorMessage) {
     <div class="col-12">
        <div class="alert alert-danger border border-danger d-flex justify-content-between align-items-center">
          <span class="text-danger fw-medium">{{ errorMessage }}</span>
          <button class="btn btn-light border border-danger text-danger" (click)="loadPolls()">
            <i class="bi bi-arrow-clockwise me-1"></i> Retry
          </button>
        </div>
      </div>
    }
    @else if (!loading && polls.length === 0) {
      <div class="col-12">
        <p class="text-muted">No polls found.</p>
      </div>
    }
    @else if (!loading && polls.length > 0) {
      @for (pollItem of polls; track pollItem.poll.id) {
        <div class="col-md-6 mb-4">
          <app-poll-card [poll]="pollItem.poll"></app-poll-card>
        </div>
      }
    }
    @else {
      <div class="d-flex justify-content-center align-items-center" style="height: 200px;">
        <div class="spinner-border text-success" role="status">
          <span class="sr-only"></span>
        </div>
      </div>
    }
  </div>

  <div class="d-flex justify-content-between mt-3">
    <button class="btn btn-outline-primary" [disabled]="page <= 1" (click)="changePage(-1)">‚¨Ö Previous</button>
    <span class="align-self-center">Page {{ page }}</span>
    <button class="btn btn-outline-primary" (click)="changePage(1)">Next ‚û°</button>
  </div>
</div>
